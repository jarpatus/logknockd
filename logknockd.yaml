file: /tmp/system.log
ruleset:
  - name: Open ports
    filter: 'drop wan in: .* SRC=([0-9.]+)'
    sequence:
      - 'drop wan in: .* SRC=([0-9.]+) .* DPT=1234'
      - 'drop wan in: .* SRC=([0-9.]+) .* DPT=5678'
      - 'drop wan in: .* SRC=([0-9.]+) .* DPT=9101'
      - 'drop wan in: .* SRC=([0-9.]+) .* DPT=1121'
    cmds:
      - 'uci set firewall.cfgxxxx.src_ip={0}'
      - 'uci set firewall.cfgxxxx.enabled=1'
      - 'uci commit'
  - name: Close ports
    filter: 'drop wan in: .* SRC=([0-9.]+)'
    sequence:
      - 'drop wan in: .* SRC=([0-9.]+) .* DPT=8765'
      - 'drop wan in: .* SRC=([0-9.]+) .* DPT=4321'
    cmds:
      - 'uci set firewall.cfgxxxx.src_ip={0}'
      - 'uci set firewall.cfgxxxx.enabled=0'
      - 'uci commit'
